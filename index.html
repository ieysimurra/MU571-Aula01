<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Composição IV - Tecnomorfismo & Escrita Pós-Digital</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React e ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para transpilar JSX no browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* Estilos globais */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #111827;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #374151;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #4B5563;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        .animate-ping {
            animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gray-950">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ÍCONES SVG INLINE (substituindo Lucide React) ---
        const Icons = {
            BookOpen: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                </svg>
            ),
            Layers: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/>
                </svg>
            ),
            Music: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>
                </svg>
            ),
            Cpu: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="20" y1="14" x2="23" y2="14"/><line x1="1" y1="9" x2="4" y2="9"/><line x1="1" y1="14" x2="4" y2="14"/>
                </svg>
            ),
            Activity: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                </svg>
            ),
            ArrowRight: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>
                </svg>
            ),
            ChevronDown: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polyline points="6 9 12 15 18 9"/>
                </svg>
            ),
            ChevronUp: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polyline points="18 15 12 9 6 15"/>
                </svg>
            ),
            Terminal: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/>
                </svg>
            ),
            Play: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
            ),
            X: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            ),
            Youtube: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
                </svg>
            ),
            Info: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
            ),
            Volume2: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>
                </svg>
            ),
            Mic2: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d="m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12"/><circle cx="17" cy="7" r="5"/>
                </svg>
            ),
            List: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/>
                </svg>
            ),
            ExternalLink: ({ size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/>
                </svg>
            )
        };

        // --- DADOS DO REPERTÓRIO ---
        const repertoireData = [
            {
                module: "Módulo 1: Paradigma Espectral",
                color: "border-blue-500",
                works: [
                    {
                        composer: "Gérard Grisey",
                        title: "Partiels",
                        year: "1975",
                        desc: "Análise do espectro do trombone orquestrado. A 'Síntese Aditiva Instrumental' nasce aqui.",
                        links: [
                            { label: "Ensemble Court-circuit", url: "https://www.youtube.com/watch?v=1QLICwmOtjc" },
                            { label: "Análise Visual", url: "https://www.youtube.com/watch?v=2LAtJHFJuog" }
                        ]
                    },
                    {
                        composer: "Gérard Grisey",
                        title: "Vortex Temporum",
                        year: "1996",
                        desc: "Mimese de formas de onda (senoidal, quadrada, serra) via arpejos e trinados.",
                        links: [
                            { label: "Performance BCMG", url: "https://www.youtube.com/watch?v=70xJ0Sdc2G8" },
                            { label: "Áudio + Partitura", url: "https://www.youtube.com/watch?v=f_CkCypPFAQ" }
                        ]
                    },
                    {
                        composer: "Tristan Murail",
                        title: "Gondwana",
                        year: "1980",
                        desc: "Simulação de FM (Frequência Modulada) orquestral. Interpolação sino-trombone.",
                        links: [
                            { label: "Ouvir Obra", url: "https://www.youtube.com/watch?v=uaPVaPPDmVs" }
                        ]
                    }
                ]
            },
            {
                module: "Módulo 2: Granularidade & Textura",
                color: "border-green-500",
                works: [
                    {
                        composer: "Iannis Xenakis",
                        title: "Metastaseis",
                        year: "1954",
                        desc: "Precursor da granularidade. Glissandi massivos criando superfícies estocásticas.",
                        links: [
                            { label: "Visualização Espectral", url: "https://www.youtube.com/watch?v=u81IGEFt7dM" },
                            { label: "Partitura", url: "https://www.youtube.com/watch?v=SZazYFchLRI" }
                        ]
                    },
                    {
                        composer: "Silvio Ferraz",
                        title: "Lamento Quase Mudo",
                        year: "2000s",
                        desc: "Violoncelo como gerador de ruído. Técnicas de fricção e sobrepressão.",
                        links: [
                            { label: "Performance", url: "https://www.youtube.com/watch?v=4gxmlRtXOiY" }
                        ]
                    },
                    {
                        composer: "Barry Truax",
                        title: "Riverrun",
                        year: "1986",
                        desc: "Síntese Granular em tempo real. O som da água gerado bit a bit.",
                        links: [
                            { label: "Ouvir Obra", url: "https://www.youtube.com/watch?v=lP1mqsNEz-s" }
                        ]
                    }
                ]
            },
            {
                module: "Módulo 3: Tempo, Loop & Glitch",
                color: "border-purple-500",
                works: [
                    {
                        composer: "Bernhard Lang",
                        title: "Monadologie V",
                        year: "2009",
                        desc: "Estética do CD riscado (Loop Mecânico) aplicada ao piano acústico.",
                        links: [
                            { label: "Marino Formenti (Piano)", url: "https://www.youtube.com/watch?v=AJeuwpY3khw" }
                        ]
                    },
                    {
                        composer: "Stefan Prins",
                        title: "Piano Hero #1",
                        year: "2011",
                        desc: "O músico como avatar. Dissociação completa entre gesto físico e som.",
                        links: [
                            { label: "Performance Zubin Kanga", url: "https://www.youtube.com/watch?v=vB7mHSxlE3g" }
                        ]
                    },
                    {
                        composer: "Flo Menezes",
                        title: "Parcours de l'Entité",
                        year: "1994",
                        desc: "Maximalismo. A densidade da escrita instrumental compete com a eletrônica.",
                        links: [
                            { label: "Ouvir Obra", url: "https://www.youtube.com/watch?v=3fizz1wIPko" }
                        ]
                    }
                ]
            },
            {
                module: "Módulo 4: Percussão & Corpo",
                color: "border-red-500",
                works: [
                    {
                        composer: "Helmut Lachenmann",
                        title: "Pression",
                        year: "1969",
                        desc: "Musique concrète instrumentale. O corpo do instrumento como território.",
                        links: [
                            { label: "Lucas Fels (Cello)", url: "https://www.youtube.com/watch?v=aeF6W9M8aBo" }
                        ]
                    },
                    {
                        composer: "Cesar Traldi",
                        title: "Cambucá",
                        year: "2000s",
                        desc: "Percussão múltipla brasileira. Interpretação mediada por suporte fixo.",
                        links: [
                            { label: "Performance", url: "https://www.youtube.com/watch?v=aeF6W9M8aBo" }
                        ]
                    }
                ]
            },
            {
                module: "Popular, Eletrônica & Híbridos",
                color: "border-yellow-500",
                works: [
                    {
                        composer: "Aphex Twin",
                        title: "Estética Glitch",
                        year: "Vários",
                        desc: "Uso de síntese granular para criar percussão fragmentada e IDM.",
                        links: [
                            { label: "Tutorial de Estilo", url: "https://www.youtube.com/watch?v=wSRi1q30og8" }
                        ]
                    },
                    {
                        composer: "Anitta / Prod. Gabriel do Borel",
                        title: "Funk Generation",
                        year: "2024",
                        desc: "Hibridização Funk Carioca + EDM. Tecnomorfismo cultural globalizado.",
                        links: [
                            { label: "Funk Rave (Video)", url: "https://www.youtube.com/watch?v=SXFn-m7c5vY" }
                        ]
                    },
                    {
                        composer: "SOPHIE",
                        title: "Hyperpop Sound Design",
                        year: "2015+",
                        desc: "Distorção extrema usada como ferramenta de síntese tímbrica.",
                        links: [
                            { label: "Análise de Produção", url: "https://www.youtube.com/watch?v=jGc61a9fPGo" }
                        ]
                    },
                    {
                        composer: "Arca",
                        title: "Mutant",
                        year: "2015",
                        desc: "A falha e a granulação como estética de corpo híbrido.",
                        links: [
                            { label: "Análise Sonora", url: "https://www.youtube.com/watch?v=fEzzZUUEvSk" }
                        ]
                    }
                ]
            }
        ];

        // --- COMPONENTE PRINCIPAL ---
        const CourseIntroApp = () => {
            const [activeTab, setActiveTab] = useState('repertoire');
            const [expandedModule, setExpandedModule] = useState(null);
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

            useEffect(() => {
                setIsMobileMenuOpen(false);
            }, [activeTab]);

            const toggleModule = (index) => {
                setExpandedModule(expandedModule === index ? null : index);
            };

            const renderContent = () => {
                switch (activeTab) {
                    case 'overview': return <OverviewSection />;
                    case 'modules': return <ModulesSection expandedModule={expandedModule} toggleModule={toggleModule} />;
                    case 'concepts': return <ConceptsSection />;
                    case 'repertoire': return <RepertoireSection />;
                    case 'tools': return <ToolsSection />;
                    default: return <OverviewSection />;
                }
            };

            return (
                <div className="min-h-screen bg-gray-950 text-gray-100 font-sans pb-12" style={{fontFamily: 'system-ui, -apple-system, sans-serif'}}>
                    {/* Header Fixo */}
                    <header className="bg-gray-900/95 backdrop-blur-md border-b border-gray-800 p-4 sticky top-0 z-40 shadow-2xl">
                        <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                            <div className="flex items-center justify-between w-full md:w-auto">
                                <div>
                                    <h1 className="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 tracking-tight">
                                        Composição IV
                                    </h1>
                                    <p className="text-gray-400 text-xs md:text-sm mt-0.5 font-medium">Tecnomorfismo & Escrita Pós-Digital</p>
                                </div>
                                
                                <button 
                                    className="md:hidden text-gray-400 hover:text-white p-2 rounded-lg hover:bg-gray-800 transition-colors"
                                    onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
                                >
                                    {isMobileMenuOpen ? <Icons.X size={24} /> : <Icons.List size={24} />}
                                </button>
                            </div>

                            <div className="hidden md:flex items-center gap-3">
                                <div className="px-3 py-1 bg-cyan-950/50 rounded border border-cyan-800 text-xs font-mono text-cyan-400">
                                    Aula 00
                                </div>
                                <div className="px-3 py-1 bg-purple-950/50 rounded border border-purple-800 text-xs font-mono text-purple-400">
                                    Pós-Graduação
                                </div>
                            </div>
                        </div>
                        
                        {/* Menu Mobile Dropdown */}
                        {isMobileMenuOpen && (
                            <div className="md:hidden mt-4 border-t border-gray-800 pt-2 animate-fadeIn bg-gray-900 absolute left-0 right-0 px-4 pb-4 shadow-xl border-b z-50">
                                <nav className="flex flex-col gap-2">
                                    <MobileNavItem id="overview" label="Visão Geral" icon={<Icons.Activity size={16} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <MobileNavItem id="modules" label="Arco do Curso" icon={<Icons.Layers size={16} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <MobileNavItem id="concepts" label="Conceitos" icon={<Icons.Cpu size={16} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <MobileNavItem id="repertoire" label="Repertório" icon={<Icons.Music size={16} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <MobileNavItem id="tools" label="Ferramentas" icon={<Icons.Terminal size={16} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                </nav>
                            </div>
                        )}
                    </header>

                    <main className="max-w-7xl mx-auto p-4 md:p-6 flex flex-col lg:flex-row gap-6 mt-4">
                        {/* Sidebar Desktop */}
                        <nav className="hidden lg:block w-64 flex-shrink-0 z-10">
                            <div className="bg-gray-900 rounded-xl p-4 sticky top-32 border border-gray-800 shadow-xl">
                                <ul className="space-y-2">
                                    <NavItem id="overview" label="Visão Geral" icon={<Icons.Activity size={18} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <NavItem id="modules" label="Arco do Curso" icon={<Icons.Layers size={18} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <NavItem id="concepts" label="Conceitos" icon={<Icons.Cpu size={18} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                    <NavItem id="repertoire" label="Repertório & Player" icon={<Icons.Music size={18} />} activeTab={activeTab} setActiveTab={setActiveTab} highlight={true} />
                                    <NavItem id="tools" label="Ferramentas" icon={<Icons.Terminal size={18} />} activeTab={activeTab} setActiveTab={setActiveTab} />
                                </ul>
                            </div>
                        </nav>

                        {/* Área de Conteúdo Principal */}
                        <div className="flex-grow min-w-0">
                            <div className="bg-gray-900 rounded-xl border border-gray-800 p-4 md:p-8 shadow-2xl min-h-[600px] relative overflow-hidden">
                                <div className="absolute top-0 right-0 w-64 h-64 bg-cyan-500/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>
                                {renderContent()}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        // --- SEÇÃO DE REPERTÓRIO ---
        const RepertoireSection = () => {
            const [filter, setFilter] = useState('all');
            const [activeVideo, setActiveVideo] = useState(null);

            const getYoutubeId = (url) => {
                if (!url) return null;
                try {
                    const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
                    const match = url.match(regExp);
                    return (match && match[2].length === 11) ? match[2] : null;
                } catch (e) {
                    console.error("Erro ao analisar URL:", e);
                    return null;
                }
            };

            const handlePlay = (work, link) => {
                const videoId = getYoutubeId(link.url);
                if (videoId) {
                    const newVideo = { ...work, videoId, url: link.url };
                    setActiveVideo(newVideo);
                    if (window.innerWidth < 1024) {
                        window.scrollTo({ top: 120, behavior: 'smooth' });
                    }
                } else {
                    window.open(link.url, '_blank');
                }
            };

            return (
                <div className="flex flex-col lg:flex-row gap-6 h-full animate-fadeIn">
                    {/* Coluna da Esquerda: Lista de Obras */}
                    <div className={`flex-1 space-y-6 transition-all duration-500 ${activeVideo ? 'lg:w-1/2' : 'w-full'}`}>
                        <div>
                            <h2 className="text-2xl font-bold text-cyan-400 mb-2">Repertório de Estudo</h2>
                            <p className="text-gray-400 text-sm mb-4">
                                Selecione uma obra para carregar a análise e o áudio.
                            </p>
                            
                            <div className="flex gap-2 overflow-x-auto pb-2 mb-4 hide-scrollbar">
                                {['all', 'Módulo 1', 'Módulo 2', 'Módulo 3', 'Módulo 4', 'Popular'].map(f => (
                                    <button
                                        key={f}
                                        onClick={() => setFilter(f)}
                                        className={`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${
                                            (filter === f || (f === 'all' && filter === 'all'))
                                            ? 'bg-cyan-600 text-white border-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.4)]'
                                            : 'bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-gray-200'
                                        }`}
                                    >
                                        {f === 'all' ? 'Ver Todos' : f.replace('Módulo ', 'Mód ')}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="space-y-6 overflow-y-auto max-h-[800px] pr-2 custom-scrollbar">
                            {repertoireData.map((section, idx) => {
                                const showSection = filter === 'all' || 
                                    (filter === 'Popular' && section.module.includes('Popular')) ||
                                    section.module.includes(filter);

                                if (!showSection) return null;
                                
                                return (
                                    <div key={idx} className={`border-l-2 ${section.color} pl-4 animate-fadeIn`}>
                                        <h3 className="text-lg font-bold text-gray-200 mb-3 flex items-center gap-2">
                                            {section.module}
                                        </h3>
                                        <div className="grid gap-3">
                                            {section.works.map((work, wIdx) => (
                                                <div 
                                                    key={wIdx} 
                                                    onClick={() => handlePlay(work, work.links[0])}
                                                    className={`group bg-gray-800/40 p-4 rounded-lg border border-gray-700 cursor-pointer transition-all duration-200 hover:shadow-lg hover:border-cyan-500/50 hover:bg-gray-800 ${activeVideo?.title === work.title ? 'bg-cyan-900/20 border-cyan-500 ring-1 ring-cyan-500/30' : ''}`}
                                                >
                                                    <div className="flex justify-between items-start mb-1">
                                                        <div>
                                                            <h4 className={`font-bold text-sm ${activeVideo?.title === work.title ? 'text-cyan-300' : 'text-gray-100 group-hover:text-cyan-200'}`}>
                                                                {work.title}
                                                            </h4>
                                                            <span className="text-xs text-gray-400 font-medium">{work.composer}</span>
                                                        </div>
                                                        <span className="text-[10px] font-mono text-gray-500 bg-gray-900 px-2 py-0.5 rounded border border-gray-800">{work.year}</span>
                                                    </div>
                                                    <p className="text-xs text-gray-400 mt-2 mb-3 leading-relaxed">{work.desc}</p>
                                                    
                                                    <div className="flex flex-wrap gap-2 mt-auto">
                                                        {work.links.map((link, lIdx) => (
                                                            <button
                                                                key={lIdx}
                                                                onClick={(e) => { e.stopPropagation(); handlePlay(work, link); }}
                                                                className="flex items-center gap-1.5 px-2.5 py-1.5 bg-gray-900 hover:bg-cyan-600 hover:text-white text-gray-300 rounded text-xs transition-colors border border-gray-700 hover:border-cyan-500"
                                                            >
                                                                {link.url.includes('youtube') ? <Icons.Play size={10} className="fill-current" /> : <Icons.ExternalLink size={10} />}
                                                                {link.label}
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Coluna da Direita: Player de Vídeo */}
                    <div className={`lg:w-1/2 transition-all duration-500 ease-in-out ${activeVideo ? 'opacity-100 translate-x-0' : 'opacity-0 translate-x-10 hidden lg:block lg:w-0'}`}>
                        <div className="sticky top-6 bg-gray-900 rounded-xl overflow-hidden border border-gray-700 shadow-2xl ring-1 ring-white/10">
                            {activeVideo ? (
                                <>
                                    <div className="bg-gray-800 p-3 flex justify-between items-center border-b border-gray-700">
                                        <div className="flex items-center gap-2.5">
                                            <span className="relative flex h-2.5 w-2.5">
                                                <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                                                <span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500"></span>
                                            </span>
                                            <span className="text-xs font-bold text-gray-200 uppercase tracking-wider">Reproduzindo</span>
                                        </div>
                                        <button 
                                            onClick={() => setActiveVideo(null)} 
                                            className="text-gray-400 hover:text-white hover:bg-gray-700 p-1 rounded transition-colors"
                                            aria-label="Fechar player"
                                        >
                                            <Icons.X size={18} />
                                        </button>
                                    </div>

                                    <div className="relative pt-[56.25%] bg-black group">
                                        <iframe
                                            src={`https://www.youtube.com/embed/${activeVideo.videoId}?autoplay=1&rel=0`}
                                            className="absolute top-0 left-0 w-full h-full"
                                            title={activeVideo.title}
                                            frameBorder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowFullScreen
                                        ></iframe>
                                    </div>

                                    <div className="p-5">
                                        <h3 className="font-bold text-xl text-cyan-400 leading-tight mb-1">{activeVideo.title}</h3>
                                        <p className="text-sm font-medium text-gray-300 mb-4">{activeVideo.composer}</p>
                                        
                                        <div className="bg-gray-800/50 p-4 rounded-lg border border-gray-700">
                                            <h4 className="text-xs uppercase font-bold text-gray-500 mb-2 flex items-center gap-2">
                                                <Icons.Info size={12} /> Contexto Tecnomórfico
                                            </h4>
                                            <p className="text-sm text-gray-300 leading-relaxed">{activeVideo.desc}</p>
                                        </div>

                                        <div className="mt-4 flex gap-2">
                                            <div className="text-xs text-gray-500 flex items-center gap-1 bg-gray-900 px-2 py-1 rounded border border-gray-800">
                                                <Icons.Volume2 size={12} />
                                                Áudio
                                            </div>
                                            <div className="text-xs text-gray-500 flex items-center gap-1 bg-gray-900 px-2 py-1 rounded border border-gray-800">
                                                <Icons.Mic2 size={12} />
                                                Análise Espectral
                                            </div>
                                        </div>
                                    </div>
                                </>
                            ) : (
                                <div className="h-96 flex flex-col items-center justify-center text-gray-500 p-8 text-center bg-gray-900/50">
                                    <Icons.Youtube size={64} className="mb-4 opacity-20" />
                                    <h3 className="text-lg font-medium text-gray-400">Player de Estudo</h3>
                                    <p className="text-sm max-w-xs mt-2 opacity-60">Selecione um exemplo na lista à esquerda para carregar a análise e o áudio correspondente.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // --- SUB-SEÇÕES ---
        const OverviewSection = () => (
            <div className="space-y-8 animate-fadeIn max-w-4xl">
                <div>
                    <h2 className="text-2xl font-bold text-cyan-400 mb-4 border-b border-gray-800 pb-2">A Premissa do Curso</h2>
                    <p className="text-lg leading-relaxed text-gray-300">
                        O objetivo deste curso não é ensinar a usar o computador para compor, mas sim entender como o computador <span className="text-white font-semibold italic">já reescreveu</span> a maneira como ouvimos e escrevemos para instrumentos acústicos.
                    </p>
                    <div className="mt-6 p-6 bg-gray-800/50 rounded-lg border-l-4 border-cyan-500 shadow-lg">
                        <p className="text-xl font-light italic text-gray-200">
                            "O tecnomorfismo é a internalização da máquina pelo humano."
                        </p>
                    </div>
                </div>

                <div>
                    <h3 className="text-xl font-bold text-blue-400 mb-6 flex items-center gap-2">
                        <Icons.BookOpen size={20} /> A Analogia Central: O Espelho Digital
                    </h3>
                    <div className="grid md:grid-cols-2 gap-6">
                        <div className="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-gray-600 transition-colors">
                            <h4 className="font-bold text-white mb-2 flex items-center gap-2">
                                <span className="w-2 h-2 rounded-full bg-gray-500"></span> Séculos Passados
                            </h4>
                            <p className="text-sm text-gray-400 leading-relaxed">
                                A música instrumental olhava para a <strong>Natureza</strong> (pássaros, trovões) ou para a <strong>Linguagem</strong> (retórica) em busca de modelos. O instrumento era uma extensão da voz ou do cenário.
                            </p>
                        </div>
                        <div className="bg-gradient-to-br from-cyan-900/20 to-blue-900/20 p-6 rounded-xl border border-cyan-800 relative overflow-hidden group hover:border-cyan-600 transition-all">
                            <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                                <Icons.Cpu size={80} />
                            </div>
                            <h4 className="font-bold text-cyan-300 mb-2 flex items-center gap-2">
                                <span className="w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.8)]"></span> Século XX / XXI
                            </h4>
                            <p className="text-sm text-gray-300 leading-relaxed relative z-10">
                                O instrumento acústico olha para o <strong>Espelho Digital</strong>. Ele vê uma imagem granulada, filtrada, editada e processada. O objetivo é fazer a orquestra soar como um <em>delay</em>, um <em>glitch</em> ou um sintetizador.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        );

        const ModulesSection = ({ expandedModule, toggleModule }) => {
            const modules = [
                {
                    weeks: "Semanas 1-3",
                    title: "O Alicerce Filosófico",
                    subtitle: "Simondon, Transdução e Tipomorfologia",
                    content: "A Transdução como operação de conversão de energia. Revisão da Tipomorfologia de Pierre Schaeffer (massa, grão, allure). A escuta reduzida como ferramenta analítica para texturas instrumentais."
                },
                {
                    weeks: "Semanas 4-6",
                    title: "A Microcirurgia do Timbre",
                    subtitle: "Espectralismo e Síntese Instrumental",
                    content: "Análise de espectro (FFT) e orquestração de parciais. Síntese Aditiva Instrumental (modelos de Grisey e Murail). Síntese Subtrativa e escultura de ruído através de técnicas estendidas."
                },
                {
                    weeks: "Semanas 7-9",
                    title: "O Tempo Pós-Digital",
                    subtitle: "Granulação, Loop e Glitch",
                    content: "Síntese Granular e Concatenativa (CSS) como modelos de escrita orquestral. A estética do Loop (repetição mecânica) e do Glitch (erro digital) na música acústica."
                },
                {
                    weeks: "Semanas 10-12",
                    title: "O Corpo e a Máquina",
                    subtitle: "Percussão, Performance e Maximalismo",
                    content: "Percussão como sintetizador de ruído branco. O corpo do intérprete como controlador/avatar (Stefan Prins). Maximalismo e densidade informacional (Flo Menezes)."
                },
                {
                    weeks: "Semanas 13-15",
                    title: "As Novas Fronteiras",
                    subtitle: "Biomoformismo e Improvisação",
                    content: "Biomoformismo: tecnologia modelando a natureza (Patricia Alessandrini). Crítica ao especismo. Improvisação livre mediada por sistemas de escuta de máquina."
                }
            ];

            return (
                <div className="space-y-6 max-w-4xl">
                    <h2 className="text-2xl font-bold text-cyan-400 mb-6 flex items-center gap-2">
                        <Icons.Layers size={24}/> Arco do Curso
                    </h2>
                    <div className="relative border-l-2 border-gray-800 ml-3 space-y-6">
                        {modules.map((mod, idx) => (
                            <div key={idx} className="ml-6 relative">
                                <div className={`absolute -left-[33px] top-6 w-4 h-4 rounded-full border-4 border-gray-900 ${expandedModule === idx ? 'bg-cyan-500 shadow-[0_0_15px_rgba(6,182,212,0.6)]' : 'bg-gray-700'} transition-all duration-300`}></div>
                                <div 
                                    className={`bg-gray-800/40 rounded-xl border ${expandedModule === idx ? 'border-cyan-700 bg-gray-800' : 'border-gray-700'} overflow-hidden cursor-pointer transition-all duration-300 hover:border-gray-600 group`}
                                    onClick={() => toggleModule(idx)}
                                >
                                    <div className="p-5 flex justify-between items-center">
                                        <div>
                                            <span className={`text-xs font-mono mb-1 block transition-colors ${expandedModule === idx ? 'text-cyan-400' : 'text-gray-500'}`}>{mod.weeks}</span>
                                            <h3 className="font-bold text-lg text-gray-100 group-hover:text-cyan-200 transition-colors">{mod.title}</h3>
                                            <p className="text-sm text-gray-400">{mod.subtitle}</p>
                                        </div>
                                        {expandedModule === idx ? <Icons.ChevronUp className="text-cyan-400" /> : <Icons.ChevronDown className="text-gray-600 group-hover:text-gray-400" />}
                                    </div>
                                    
                                    {expandedModule === idx && (
                                        <div className="px-5 pb-5 pt-0 text-gray-300 text-sm border-t border-gray-700/50 mt-2 pt-4 animate-fadeIn">
                                            <p className="leading-relaxed">{mod.content}</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ConceptsSection = () => (
            <div className="space-y-6">
                <h2 className="text-2xl font-bold text-cyan-400 mb-6 flex items-center gap-2">
                    <Icons.Cpu size={24}/> Conceitos Fundamentais
                </h2>
                <div className="grid md:grid-cols-2 gap-6">
                    <ConceptCard 
                        title="Tecnomorfismo" 
                        def="Techne + Morphe" 
                        desc="Uso metafórico de processos tecnológicos em meios acústicos. Não é usar um computador, é pensar como um." 
                    />
                    <ConceptCard 
                        title="Transdução" 
                        def="Gilbert Simondon" 
                        desc="Passagem de informação entre domínios heterogêneos. O compositor converte lógica digital em energia acústica." 
                    />
                    <ConceptCard 
                        title="Escuta Reduzida" 
                        def="Pierre Schaeffer" 
                        desc="Ouvir a morfologia (massa, grão, allure) ignorando a causa do som. Essencial para analisar texturas complexas." 
                    />
                    <ConceptCard 
                        title="Simulativo vs Metafórico" 
                        def="Holmes / Catanzaro" 
                        desc="Simulativo: Imitar a superfície sonora (ex: ruído branco). Metafórico: Imitar a lógica estrutural (ex: loop, corte)." 
                    />
                </div>
            </div>
        );

        const ConceptCard = ({ title, def, desc }) => (
            <div className="bg-gray-800/50 p-6 rounded-xl border-l-4 border-purple-500 hover:bg-gray-800 transition-all hover:translate-x-1">
                <div className="flex justify-between items-start mb-2">
                    <h3 className="font-bold text-xl text-white">{title}</h3>
                    <Icons.Cpu size={16} className="text-purple-500 opacity-50"/>
                </div>
                <span className="text-xs uppercase tracking-wider text-purple-400 font-mono mb-3 block">{def}</span>
                <p className="text-sm text-gray-300 leading-relaxed">{desc}</p>
            </div>
        );

        const ToolsSection = () => (
            <div className="space-y-8 max-w-4xl">
                <div>
                    <h2 className="text-2xl font-bold text-cyan-400 mb-6 flex items-center gap-2">
                        <Icons.Terminal size={24}/> Ferramentas & Diagnóstico
                    </h2>
                    <div className="grid md:grid-cols-2 gap-4 mb-8">
                        <div className="bg-gray-800 p-5 rounded-xl border border-gray-700 flex items-start gap-4">
                            <div className="p-3 bg-gray-900 rounded-lg text-cyan-400">
                                <Icons.Activity size={24} />
                            </div>
                            <div>
                                <h3 className="font-bold text-white mb-1">Sonic Visualiser</h3>
                                <p className="text-sm text-gray-400">Software para ver o som. Analisaremos espectrogramas para entender o "grão" e a "massa" interna.</p>
                            </div>
                        </div>
                        <div className="bg-gray-800 p-5 rounded-xl border border-gray-700 flex items-start gap-4">
                            <div className="p-3 bg-gray-900 rounded-lg text-purple-400">
                                <Icons.Layers size={24} />
                            </div>
                            <div>
                                <h3 className="font-bold text-white mb-1">Lógica DSP</h3>
                                <p className="text-sm text-gray-400">Conceitos de processamento de sinal: Filtros (Low-Pass), Envelope Follower, Delay Lines.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div className="bg-gradient-to-r from-gray-800 to-gray-900 p-8 rounded-xl border border-gray-700 shadow-lg">
                    <h3 className="text-xl font-bold text-white mb-6">Diagnóstico Inicial da Turma</h3>
                    <div className="space-y-4">
                        <div className="flex gap-4">
                            <span className="flex-shrink-0 w-8 h-8 rounded-full bg-cyan-900/50 border border-cyan-700 text-cyan-400 flex items-center justify-center font-bold text-sm">1</span>
                            <p className="text-gray-300 text-sm md:text-base pt-1">Você já tentou transcrever um som eletrônico para seu instrumento? Qual foi a maior dificuldade (timbre, sustentação)?</p>
                        </div>
                        <div className="flex gap-4">
                            <span className="flex-shrink-0 w-8 h-8 rounded-full bg-cyan-900/50 border border-cyan-700 text-cyan-400 flex items-center justify-center font-bold text-sm">2</span>
                            <p className="text-gray-300 text-sm md:text-base pt-1">Quais compositores brasileiros você associa imediatamente ao uso de tecnologia na escrita?</p>
                        </div>
                    </div>
                </div>
            </div>
        );

        // --- COMPONENTES UI AUXILIARES ---
        const NavItem = ({ id, label, icon, activeTab, setActiveTab, highlight }) => (
            <li>
                <button
                    onClick={() => setActiveTab(id)}
                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 group ${
                        activeTab === id 
                        ? 'bg-cyan-600 text-white shadow-lg shadow-cyan-900/20' 
                        : highlight 
                            ? 'bg-gray-800 text-cyan-400 border border-cyan-900/30 hover:border-cyan-500/50'
                            : 'text-gray-400 hover:bg-gray-800 hover:text-white'
                    }`}
                >
                    <span className={activeTab === id ? 'text-white' : highlight ? 'text-cyan-400' : 'text-gray-500 group-hover:text-white transition-colors'}>
                        {icon}
                    </span>
                    <span className="text-sm font-medium">{label}</span>
                    {activeTab === id && <Icons.ArrowRight size={14} className="ml-auto animate-pulse" />}
                </button>
            </li>
        );

        const MobileNavItem = ({ id, label, icon, activeTab, setActiveTab }) => (
            <button
                onClick={() => setActiveTab(id)}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${
                    activeTab === id 
                        ? 'bg-cyan-600 text-white' 
                        : 'text-gray-300 hover:bg-gray-800'
                }`}
            >
                {icon}
                <span className="text-sm font-medium">{label}</span>
            </button>
        );

        // --- RENDERIZAÇÃO ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CourseIntroApp />);
    </script>
</body>
</html>
